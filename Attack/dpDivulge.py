#!/usr/bin/python3
# -*- codeing = utf-8 -*-
# @Time : 22:30
# @Author : Tptfb11
# @File : dpDivulge.py
# @Software : PyCharm
from gmpy2 import invert, powmod

e = 65537
n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847
# 密文
c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869
dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825

def action(e,n,c,dp):
    try:
        res = ""
        for x in range(1, e):
            if (e * dp % x == 1):
                p = (e * dp - 1) // x + 1
                if (n % p != 0):
                    continue
                q = n // p
                phin = (p - 1) * (q - 1)
                d = invert(e, phin)
                m = powmod(c, d, n)
                if (len(hex(m)[2:]) % 2 == 1):
                    continue

                print("m:", m)
                # print(hex(m)[2:])
                res = bytes.fromhex(hex(m)[2:])
                print("flag:", res)
        if res == "":
            return "此方法不适用"
        return res
    except:
        return "error"
